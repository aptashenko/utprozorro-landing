<template>
  <div class="px-[20px] pt-[40px] pb-[80px] min-h-[100dvh] flex flex-col">
    <h2 class="text-[#C7D2FF] text-center text-[16px] font-[600] leading-[1.2] mb-[26px]">
      –©–æ –∫–∞–∂—É—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∏, —è–∫—ñ –ø—Ä–æ–π—à–ª–∏ –∫—É—Ä—Å
    </h2>
    <div class="flex-1">
      <div class="relative pb-[100px]">
        <transition name="slide-left" mode="out-in">
          <review-message v-show="reviewIdx >= 1" name="–ê–Ω–Ω–∞" class="max-w-[314px]">
          <span>
            ¬´–ö—É—Ä—Å –¥–æ–ø–æ–º—ñ–≥ –º–µ–Ω—ñ <span class="text-[#5754FF]">—à–≤–∏–¥–∫–æ –æ—Å–≤–æ—ó—Ç–∏</span> –≤—Å—ñ –∞—Å–ø–µ–∫—Ç–∏ —Ä–æ–±–æ—Ç–∏ –∑ —Ç–µ–Ω–¥–µ—Ä–∞–º–∏. <span class="text-[#5754FF]">–í–∂–µ –æ—Ç—Ä–∏–º–∞–ª–∞ –∫—ñ–ª—å–∫–∞ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ–π!</span> üëç¬ª
          </span>
          </review-message>
        </transition>
        <transition name="slide-right" mode="out-in">
          <review-message
            v-show="reviewIdx >= 2"
            name="–î–º–∏—Ç—Ä–æ"
            shadow
            class="absolute bottom-0 right-0 max-w-[234px]"
          >
          <span>
            ¬´–ö—É—Ä—Å –≤—ñ–¥–∫—Ä–∏–≤ –¥–ª—è –º–µ–Ω–µ <span class="text-[#5754FF]">–Ω–æ–≤—ñ –∫–∞—Ä'—î—Ä–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ</span>. –ü—Ä–∞—Ü—é—é —Ç–µ–Ω–¥–µ—Ä–Ω–∏–º —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç–æ–º –≤ –Ü–¢-–∫–æ–º–ø–∞–Ω—ñ—ó¬ª
          </span>
          </review-message>
        </transition>
      </div>
      <div class="mx-auto my-[10px]">
        <div class="bg-[#54468A] blur-[100px] w-[174px] h-[174px] absolute-center-x absolute-center-y z-[-1]" />
        <img
            src="@/assets/images/rating.png"
            class="w-[235px] mx-auto block transition duration-500"
            :class="[reviewIdx >= 5 ? 'opacity-100' : 'opacity-0']"
        />
      </div>
      <div class="relative pb-[85px]">
        <transition name="slide-left" mode="out-in">
          <review-message
            v-show="reviewIdx >= 3"
            name="–û–ª–µ–Ω–∞"
            shadow
            class="w-[224px] relative left-0"
          >
          <span>
            ¬´–í—ñ–¥–º—ñ–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è!  <span class="text-[#5754FF]">–ë–∞–≥–∞—Ç–æ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–∞ –∫–æ—Ä–∏—Å–Ω–∏—Ö –ø–æ—Ä–∞–¥.</span> –í–ø–µ–≤–Ω–µ–Ω–∏–π —É —Å–≤–æ—ó—Ö —Å–∏–ª–∞—Ö¬ª
          </span>
          </review-message>
        </transition>
        <transition name="slide-right" mode="out-in">
          <review-message
            v-show="reviewIdx >= 4"
            name="–ú–∞–∫—Å–∏–º"
            shadow
            class="w-[252px] absolute bottom-0 right-[-10px]"
          >
          <span>
            ¬´–î—É–∂–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–∞ –∫—É—Ä—Å–æ–º. –í—Å–µ <span class="text-[#5754FF]">–∑—Ä–æ–∑—É–º—ñ–ª–æ —Ç–∞ –¥–æ—Å—Ç—É–ø–Ω–æ.</span> –ü—Ä–∞—Ü—é—é —Ç–µ–Ω–¥–µ—Ä–Ω–∏–º —Å–ø–µ—Ü—ñ–∞–ª—ñ—Å—Ç–æ–º <span class="text-[#5754FF]">—É –≤–µ–ª–∏–∫—ñ–π –∫–æ–º–ø–∞–Ω—ñ—ó</span>üöÄ¬ª
          </span>
          </review-message>
        </transition>
      </div>
    </div>
    <transition name="fade" mode="out-in">
      <div v-show="reviewIdx >= 6" class="fixed bg-primary bottom-0 left-0 py-[10px] px-[20px] w-full">
        <div class="max-w-[32rem] mx-auto">
          <base-button variant="quiz" :to="nextQuestionPath" class="w-full">
            –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏
          </base-button>
        </div>
      </div>
    </transition>
  </div>
</template>

<script setup>
import {ref} from "vue";
import iterateWithDelay from "@/utils/iterate-with-delay.js";
import BaseButton from "@/components/ui/BaseButton.vue";
import {useQuiz} from "@/composables/useQuiz.js";
import ReviewMessage from '@/components/quiz/reviews-elements/ReviewMessage.vue'

const steps = [1,2,3,4,5,6];
const reviewIdx = ref(0);

const { nextQuestionPath } = useQuiz()

const setIdx = idx => {
  reviewIdx.value = idx
}

iterateWithDelay({array: steps, callback: setIdx, delay: 1000})
</script>
